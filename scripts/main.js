"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var l=0;l<t.length;l++){var i=t[l];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,l,i){return l&&e(t.prototype,l),i&&e(t,i),t}}(),XmlEditor=function(){function e(){_classCallCheck(this,e),this.xmlFile=null,this.xsltFile=null,this.xsdFile=null,self=this,$("input[type=file]").on("change",function(e){var t=e.target.files[0],l=$(e.target).parents();console.log("input change",e.target,l),self.loadFile(t,l.filter(".editor").find("juicy-ace-editor")),"xml"==l.filter(".editor").attr("id")?self.xmlFile=t:"xslt"==l.filter(".editor").attr("id")?self.xsltFile=t:self.xsdFile=t}),$("#compile").on("click",function(e){var t=new XSLTProcessor;t.importStylesheet(self.xslt);var l=t.transformToDocument(self.xml,document),i=new XMLSerializer;$("#output juicy-ace-editor")[0].editor.setValue(vkbeautify.xml(i.serializeToString(l)),-1)}),$("#validate").on("click",function(e){var t=xmllint.validateXML({xml:self.xmlText,schema:self.xsd}),l=$("#output juicy-ace-editor")[0];t.errors?l.editor.setValue(t.errors.join("\n")):l.editor.setValue("XML validates against XSD")}),$("#example").on("click",function(e){self.loadExampleFile("example_5.xml","xml"),self.loadExampleFile("example_5.xsl","xslt"),self.loadExampleFile("example_5.xsd","xsd")}),$("juicy-ace-editor").each(function(e,t){t.editor.on("input",function(){var l=$(t).parents(),i=l.filter(".editor").find(".download")[0],a=encodeURIComponent(t.editor.getValue());i.setAttribute("href","data:text/plain;charset=utf-8,"+a);var r;r=0==e?self.xmlFile?self.xmlFile.name:"example.xml":1==e?self.xsltFile?self.xsltFile.name:"example.xsl":2==e?self.xsdFile?self.xsdFile.name:"example.xsd":"output.html",i.setAttribute("download",r)})})}return _createClass(e,[{key:"xml",get:function(){var e=new DOMParser,t=$("#xml juicy-ace-editor")[0];return e.parseFromString(t.editor.getValue(),"text/xml")}},{key:"xmlText",get:function(){var e=$("#xml juicy-ace-editor")[0];return e.editor.getValue()}},{key:"xslt",get:function(){var e=new DOMParser,t=$("#xslt juicy-ace-editor")[0];return e.parseFromString(t.editor.getValue(),"text/xml")}},{key:"xsltText",get:function(){var e=$("#xslt juicy-ace-editor")[0];return e.editor.getValue()}},{key:"xsd",get:function(){var e=$("#xsd juicy-ace-editor")[0];return e.editor.getValue()}}]),_createClass(e,[{key:"loadExampleFile",value:function(e,t){$.ajax({method:"GET",url:"test-files/"+e,dataType:"text"}).done(function(e){var l=$("#"+t+" juicy-ace-editor")[0];l.editor.setValue(e)})}},{key:"loadFile",value:function(e,t){var l=new FileReader;l.onload=function(e){console.log(t),t[0].editor.setValue(vkbeautify.xml(e.target.result),-1)},l.readAsText(e)}}]),e}();$(function(){new XmlEditor});